{"version":3,"sources":["turbopack:///[project]/HandS/frontend/node_modules/next/navigation.js","turbopack:///[project]/HandS/frontend/app/verify.tsx","turbopack:///[project]/HandS/frontend/app/users/page.tsx"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n","\"use client\";\r\nconst API_BASE = \"http://127.0.0.1:8000\";\r\n\r\nexport default async function Verify() {\r\n    const token = sessionStorage.getItem(\"token\");\r\n\r\n    const res = await fetch(`${API_BASE}/verify`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ \"token\": token }),\r\n    });\r\n    if (!res.ok) {\r\n        const refresh_token = sessionStorage.getItem(\"refresh_token\");\r\n        const refreshRes = await fetch(`${API_BASE}/refresh`, {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify({\"refresh_token\":refresh_token }),\r\n        });\r\n        if (!refreshRes.ok) {\r\n            throw new Error(\"Failed to refresh token\");\r\n        }\r\n        const refreshData = await refreshRes.json();\r\n        sessionStorage.setItem(\"token\", refreshData.access_token);\r\n        return refreshData;\r\n    }\r\n    const data = await res.json();\r\n    return data;\r\n  }","\"use client\";\r\nimport Link from \"next/link\";\r\nimport { useState, useEffect, use } from \"react\";\r\nimport Verify from \"../verify\";\r\n\r\nimport { useRouter } from \"next/navigation\";\r\nimport { verify } from \"crypto\";\r\n\r\nconst API_BASE = \"http://127.0.0.1:8000\";\r\n\r\nexport default function Users() {\r\n    const router = useRouter();\r\n    const [users, setUsers] = useState([] as any[]);\r\n\r\n    async function fetchUsers() {\r\n        try {\r\n            const user = await fetch(`${API_BASE}/user/read_all`, {\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n            });\r\n            const data = await user.json();\r\n            setUsers(data);\r\n            console.log(data);\r\n\r\n        } catch (error) {\r\n            console.error(\"Error fetching users:\", error);\r\n        }\r\n    }\r\n    async function checkVerify() {\r\n        const verifyResult = await Verify();\r\n        if (verifyResult.role !== \"admin\") {\r\n            alert(\"관리자만 접근할 수 있습니다.\");\r\n            router.push(\"/\");\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        checkVerify();\r\n        fetchUsers();\r\n    }, []);\r\n\r\n    function deleteUser(id: string) {\r\n        fetch(`${API_BASE}/user/delete`, {\r\n            method: \"DELETE\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\",\r\n            },\r\n            body: JSON.stringify({ id }),\r\n        })\r\n            .then((response) => {\r\n                if (!response.ok) {\r\n                    throw new Error(\"Network response was not ok\");\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(() => {\r\n                setUsers((prevUsers) => prevUsers.filter((user) => user.id !== id));\r\n            })\r\n            .catch((error) => {\r\n                console.error(\"Error deleting user:\", error);\r\n            });\r\n    }\r\n\r\n    function createUser() {\r\n        router.push(`/users/signup`);\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8\">\r\n            <h1 className=\"text-2xl font-bold mb-4\">User List</h1>\r\n            <button\r\n                onClick={createUser}\r\n                className=\"mb-4 bg-blue-500 text-white px-4 py-2 rounded\"\r\n            >\r\n                Create User\r\n            </button>\r\n            <ul>\r\n                {users.map((user) => (\r\n                    <li key={user.id} className=\"flex justify-between items-center mb-2\">\r\n                        <span>{user.username}</span>\r\n                        <button\r\n                            onClick={() => deleteUser(user.id)}\r\n                            className=\"bg-red-500 text-white px-2 py-1 rounded\"\r\n                        >\r\n                            Delete\r\n                        </button>\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0]}